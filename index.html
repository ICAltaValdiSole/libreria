<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Scolastica I.C. Alta Val di Sole</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="all.min.css"> <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="templatemo-xtra-blog.css">
</head>
<body>

<!-- Navbar/Header Section -->
<header class="tm-header">
    <div class="tm-header-wrapper">
        <div class="tm-site-header">
            <div class="tm-site-logo">
                <i class="fas fa-book"></i>
            </div>
            <h1 class="text-white">Biblioteca Scolastica I.C. Alta Val di Sole</h1>
        </div>
        <nav class="tm-nav">
            <ul>
                <li class="tm-nav-item active"><a href="#" class="tm-nav-link">
                    <i class="fas fa-home"></i>
                    Home
                </a></li>
                <li class="tm-nav-item"><a href="#" class="tm-nav-link">
                    <i class="fas fa-book-open"></i>
                    Filtri: Libri
                </a></li>
                <li class="tm-nav-item"><a href="#" class="tm-nav-link">
                    <i class="fas fa-film"></i>
                    Filtri: DVD
                </a></li>
            </ul>
        </nav>
    </div>
</header>

<!-- Main Content -->
<div class="tm-main">
    <!-- Search Section -->
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <form class="form-inline tm-search-form">
                    <input class="form-control tm-search-input" type="text" id="searchInput" placeholder="Cerca per titolo o autore..." onkeyup="filtraLibri()">
                    <button class="tm-search-button" type="submit">
                        <i class="fas fa-search tm-search-icon"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Books Section -->
    <div class="container mt-5">
        <div class="row">
            <div class="col-lg-12">
                <h2 class="tm-post-title">Lista di Libri</h2>
                <table class="table table-bordered" id="libriTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Titolo</th>
                            <th>Autore</th>
                            <th>Disponibilit√†</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Book data will go here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="jquery.min.js"></script>
<script src="templatemo-script.js"></script>
<script>
    // Existing JavaScript code from your site to handle filters and book display.
    const sheetId = '1bHmR_g_8Rp54M1lLnZd3nD78EqRTIKNSzl1mE2-hRzQ';
    const apiKey = 'AIzaSyCBAMHlMKwdPs8hlvRnxxNOWwdXxqnKC3k';
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/libreriaprincipale?key=${apiKey}`;
    let tipoFiltrato = 'Tutti';

    async function caricaLibri() {
        const response = await fetch(url);
        const data = await response.json();
        const libri = data.values;
        const tbody = document.querySelector('#libriTable tbody');
        tbody.innerHTML = '';
        libri.shift();
        libri.forEach(libro => {
            const [id, titolo, autore, disponibilita, tipo] = libro;
            const disponibilitaClass = disponibilita === 'Disponibile' ? 'text-success' : 'text-danger';
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${id}</td>
                <td>${titolo}</td>
                <td>${autore}</td>
                <td class="${disponibilitaClass}">${disponibilita}</td>
                <td><button class="btn btn-primary" onclick="prendiInPrestito(${id})">Prenota</button></td>
            `;
            tbody.appendChild(tr);
        });
    }

    function prendiInPrestito(idLibro) {
        const urlModuloPrestito = `https://docs.google.com/forms/d/e/1FAIpQLScUNgMUgKa_URu74Ju3G1HZXDMVlNMzX1D2egxB7Ut34wzIqg/viewform?entry.1518254211=${idLibro}`;
        window.open(urlModuloPrestito, '_blank');
    }

    function filtraLibri() {
        const input = document.getElementById("searchInput").value.toLowerCase();
        const tr = document.querySelectorAll("#libriTable tbody tr");
        tr.forEach(row => {
            const tdTitolo = row.cells[1].textContent.toLowerCase();
            const tdAutore = row.cells[2].textContent.toLowerCase();
            row.style.display = (tdTitolo.includes(input) || tdAutore.includes(input)) ? "" : "none";
        });
    }

    caricaLibri();
</script>
</body>
</html>

</html>


